

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>easy_robot_control.my_rtb_fix.fixed_urdf &mdash; Motion-Stack 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Motion-Stack
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guides:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/start.html">How to start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/use.html">ROS2 nodes and interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/URDF.html">Your URDF with This Repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/api.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/easy_robot_control.html">easy_robot_control package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Future code struct.:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/motion_stack.html">motion_stack package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Motion-Stack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">easy_robot_control.my_rtb_fix.fixed_urdf</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for easy_robot_control.my_rtb_fix.fixed_urdf</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Fixes the URDF object of rtb: https://github.com/petercorke/robotics-toolbox-python/pull/441</span>

<span class="sd">Example:</span>
<span class="sd">    Overwrite the library using::</span>

<span class="sd">        import roboticstoolbox.tools.urdf.urdf as bad</span>

<span class="sd">        import easy_robot_control.my_rtb_fix.fixed_urdf as fix</span>

<span class="sd">        bad.URDF.__init__ = fix.URDF.__init__</span>
<span class="sd">        bad.URDF._recursive_axis_definition = fix.URDF._recursive_axis_definition</span>
<span class="sd">        bad.URDF.finalize_linking = fix.URDF.finalize_linking</span>

<span class="sd">Note:</span>
<span class="sd">    `easy_robot_control/__init__.py` overwrites it, so importing easy_robot_control \</span>
<span class="sd">            will change your rtb</span>

<span class="sd">@author (Original) Matthew Matl, Github: mmatl</span>
<span class="sd">@author (Adapted by) Jesse Haviland</span>
<span class="sd">@author (Fixed by) Elian Neppel</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">roboticstoolbox</span> <span class="k">as</span> <span class="nn">rtb</span>
<span class="kn">from</span> <span class="nn">roboticstoolbox.tools.urdf.urdf</span> <span class="kn">import</span> <span class="n">URDFType</span>
<span class="kn">from</span> <span class="nn">spatialmath</span> <span class="kn">import</span> <span class="n">SE3</span><span class="p">,</span> <span class="n">SO3</span>
<span class="kn">from</span> <span class="nn">spatialmath.base</span> <span class="kn">import</span> <span class="n">ArrayLike3</span><span class="p">,</span> <span class="n">getvector</span><span class="p">,</span> <span class="n">unitvec</span>


<div class="viewcode-block" id="rotation_fromVec_toVec">
<a class="viewcode-back" href="../../../api/easy_robot_control.my_rtb_fix.fixed_urdf.html#easy_robot_control.my_rtb_fix.fixed_urdf.rotation_fromVec_toVec">[docs]</a>
<span class="k">def</span> <span class="nf">rotation_fromVec_toVec</span><span class="p">(</span>
    <span class="n">from_this_vector</span><span class="p">:</span> <span class="n">ArrayLike3</span><span class="p">,</span> <span class="n">to_this_vector</span><span class="p">:</span> <span class="n">ArrayLike3</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SO3</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the rotation matrix from the first to the second vector.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        from_this_vector: ArrayLike3</span>
<span class="sd">        to_this_vector: ArrayLike3</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        rotation_from_to: SO3</span>
<span class="sd">            Rotation matrix</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        Vector length is irrelevant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">from_this_vector</span> <span class="o">=</span> <span class="n">getvector</span><span class="p">(</span><span class="n">from_this_vector</span><span class="p">)</span>
    <span class="n">to_this_vector</span> <span class="o">=</span> <span class="n">getvector</span><span class="p">(</span><span class="n">to_this_vector</span><span class="p">)</span>

    <span class="n">is_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">from_this_vector</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">is_zero</span><span class="p">:</span>
        <span class="n">target_axis</span> <span class="o">=</span> <span class="n">to_this_vector</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">target_axis</span> <span class="o">=</span> <span class="n">unitvec</span><span class="p">(</span><span class="n">from_this_vector</span><span class="p">)</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">target_axis</span><span class="p">,</span> <span class="n">to_this_vector</span><span class="p">)</span>
    <span class="n">crss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">target_axis</span><span class="p">,</span> <span class="n">to_this_vector</span><span class="p">)</span>

    <span class="n">is_parallel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">crss</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">is_parallel</span><span class="p">:</span>
        <span class="n">rotation_plane</span> <span class="o">=</span> <span class="n">unitvec</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">target_axis</span><span class="p">,</span> <span class="n">to_this_vector</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rotation_plane</span> <span class="o">=</span> <span class="n">unitvec</span><span class="p">(</span><span class="n">crss</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">dt</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">crss</span><span class="p">)</span>
    <span class="n">rotation_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">rotation_from_to</span> <span class="o">=</span> <span class="n">SO3</span><span class="o">.</span><span class="n">AngVec</span><span class="p">(</span><span class="n">rotation_angle</span><span class="p">,</span> <span class="n">rotation_plane</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rotation_from_to</span></div>



<span class="k">def</span> <span class="nf">_find_standard_joint</span><span class="p">(</span><span class="n">joint</span><span class="p">:</span> <span class="s2">&quot;Joint&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;rtb.ET | None&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds a pure rtb.ET joint corresponding to the URDF joint axis.</span>

<span class="sd">    If urdf joint is fixed, returns an empty rtb.ET.SE3.</span>
<span class="sd">    If none exists (axis is not +- 1 over x, y or z) returns None.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    joint</span>
<span class="sd">       joint object read from the urdf.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    std_joint: rtb.ET or None</span>
<span class="sd">        if a rtb.ET joint exists:</span>
<span class="sd">            Returns rtb.ET of type joint. This is rtb.ET.[SE(), Rx(), Ry(), ..., tz].</span>
<span class="sd">        else:</span>
<span class="sd">            Returns None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">std_joint</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;revolute&quot;</span><span class="p">,</span> <span class="s2">&quot;continuous&quot;</span><span class="p">):</span>  <span class="c1"># pragma nocover # noqa</span>
        <span class="k">if</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Rx</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Rx</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Ry</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Rz</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="o">==</span> <span class="s2">&quot;prismatic&quot;</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
        <span class="k">if</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">tx</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">tx</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">ty</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">ty</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">tz</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">tz</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">std_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">SE3</span><span class="p">(</span><span class="n">SE3</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">std_joint</span>


<span class="k">def</span> <span class="nf">_find_joint_ets</span><span class="p">(</span>
    <span class="n">joint</span><span class="p">:</span> <span class="s2">&quot;Joint&quot;</span><span class="p">,</span>
    <span class="n">parent_from_Rx_to_axis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SE3</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;rtb.ETS&quot;</span><span class="p">,</span> <span class="n">SE3</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the ETS of a urdf joint object to be used by a Link.</span>

<span class="sd">    This is based on the following fomula:</span>
<span class="sd">        ets(N) = axis(N-1).inv() * transl(N) * rot(N) * axis(N) * [Rx]</span>
<span class="sd">    where N is the current joint, and (N-1) the parent joint.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">        joint: Joint</span>
<span class="sd">            Joint from the urdf.</span>
<span class="sd">            Used to deduce: transl(N), rot(N), axis(N), [Rx]</span>
<span class="sd">        parent_from_Rx_to_axis: Optional[SE3]</span>
<span class="sd">            SE3 resulting from the axis orientation of the parent joint</span>
<span class="sd">            Used to deduce: axis(N-1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        ets: ETS</span>
<span class="sd">            ETS representing the joint. It ends with a joint.</span>
<span class="sd">        from_Rx_to_axis: SE3</span>
<span class="sd">            SE3 representing the rotation of the axis attribute of the joint.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">joint_trans</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">(</span><span class="n">joint</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span><span class="o">.</span><span class="n">t</span>
    <span class="n">joint_rot</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">rpy</span>
    <span class="k">if</span> <span class="n">parent_from_Rx_to_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">parent_from_Rx_to_axis</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">()</span>

    <span class="n">joint_without_axis</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">(</span><span class="n">joint_trans</span><span class="p">)</span> <span class="o">*</span> <span class="n">SE3</span><span class="o">.</span><span class="n">RPY</span><span class="p">(</span><span class="n">joint_rot</span><span class="p">)</span>

    <span class="n">std_joint</span> <span class="o">=</span> <span class="n">_find_standard_joint</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
    <span class="n">is_simple_joint</span> <span class="o">=</span> <span class="n">std_joint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">is_simple_joint</span><span class="p">:</span>
        <span class="n">from_Rx_to_axis</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">()</span>
        <span class="n">pure_joint</span> <span class="o">=</span> <span class="n">std_joint</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># rotates a Rx joint onto right axis</span>
        <span class="n">joint_axis</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">axis_of_Rx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">rotation_from_Rx_to_axis</span> <span class="o">=</span> <span class="n">rotation_fromVec_toVec</span><span class="p">(</span>
            <span class="n">from_this_vector</span><span class="o">=</span><span class="n">axis_of_Rx</span><span class="p">,</span> <span class="n">to_this_vector</span><span class="o">=</span><span class="n">joint_axis</span>
        <span class="p">)</span>
        <span class="n">from_Rx_to_axis</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">(</span><span class="n">rotation_from_Rx_to_axis</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;revolute&quot;</span><span class="p">,</span> <span class="s2">&quot;continuous&quot;</span><span class="p">):</span>
            <span class="n">pure_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">Rx</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="o">==</span> <span class="s2">&quot;prismatic&quot;</span><span class="p">:</span>  <span class="c1"># I cannot test this case</span>
            <span class="n">pure_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">tx</span><span class="p">(</span><span class="n">flip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pure_joint</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">SE3</span><span class="p">(</span><span class="n">SE3</span><span class="p">())</span>

    <span class="n">listET</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">emptySE3</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">()</span>

    <span class="c1"># skips empty SE3</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">parent_from_Rx_to_axis</span> <span class="o">==</span> <span class="n">emptySE3</span><span class="p">:</span>
        <span class="n">listET</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">SE3</span><span class="p">(</span><span class="n">parent_from_Rx_to_axis</span><span class="o">.</span><span class="n">inv</span><span class="p">()))</span>
    <span class="n">listET</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">SE3</span><span class="p">(</span><span class="n">joint_without_axis</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">from_Rx_to_axis</span> <span class="o">==</span> <span class="n">emptySE3</span><span class="p">:</span>
        <span class="n">listET</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rtb</span><span class="o">.</span><span class="n">ET</span><span class="o">.</span><span class="n">SE3</span><span class="p">(</span><span class="n">from_Rx_to_axis</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">joint</span><span class="o">.</span><span class="n">joint_type</span> <span class="o">==</span> <span class="s2">&quot;fixed&quot;</span><span class="p">:</span>
        <span class="n">listET</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pure_joint</span><span class="p">)</span>

    <span class="n">ets</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">ETS</span><span class="p">(</span><span class="n">listET</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ets</span><span class="p">,</span> <span class="n">from_Rx_to_axis</span>


<div class="viewcode-block" id="URDF">
<a class="viewcode-back" href="../../../api/easy_robot_control.my_rtb_fix.fixed_urdf.html#easy_robot_control.my_rtb_fix.fixed_urdf.URDF">[docs]</a>
<span class="k">class</span> <span class="nc">URDF</span><span class="p">(</span><span class="n">URDFType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">links</span><span class="p">,</span>
        <span class="n">joints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">transmissions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">materials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">other_xml</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">joints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
            <span class="n">joints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">transmissions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
            <span class="n">transmissions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">materials</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">materials</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># TODO, what does this next line do?</span>
        <span class="c1"># why arent the other things validated</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_transmissions</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">other_xml</span> <span class="o">=</span> <span class="n">other_xml</span>

        <span class="c1"># No setters for these</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_links</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_joints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">joints</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transmissions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">transmissions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_materials</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">materials</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_material_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_materials</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_material_map</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Two materials with name </span><span class="si">{}</span><span class="s2"> &quot;</span> <span class="s2">&quot;found&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_material_map</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

        <span class="c1"># check for duplicate names</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_links</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_links</span><span class="p">])</span>
        <span class="p">):</span>  <span class="c1"># pragma nocover  # noqa</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicate link names&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_joints</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joints</span><span class="p">])</span>
        <span class="p">):</span>  <span class="c1"># pragma nocover  # noqa</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicate joint names&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transmissions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transmissions</span><span class="p">])</span>
        <span class="p">):</span>  <span class="c1"># pragma nocover  # noqa</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicate transmission names&quot;</span><span class="p">)</span>

        <span class="n">elinks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">elinkdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># jointdict = {}</span>

        <span class="c1"># build the list of links in URDF file order</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_links</span><span class="p">:</span>
            <span class="n">elink</span> <span class="o">=</span> <span class="n">rtb</span><span class="o">.</span><span class="n">Link</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">m</span><span class="o">=</span><span class="n">link</span><span class="o">.</span><span class="n">inertial</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
                <span class="n">r</span><span class="o">=</span><span class="p">(</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">inertial</span><span class="o">.</span><span class="n">origin</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">inertial</span><span class="o">.</span><span class="n">origin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="kc">None</span>
                <span class="p">),</span>
                <span class="n">I</span><span class="o">=</span><span class="n">link</span><span class="o">.</span><span class="n">inertial</span><span class="o">.</span><span class="n">inertia</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">elinks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elink</span><span class="p">)</span>
            <span class="n">elinkdict</span><span class="p">[</span><span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">elink</span>

            <span class="c1"># add the inertial parameters</span>

            <span class="c1"># add the visuals to visual list</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elink</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">ob</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">link</span><span class="o">.</span><span class="n">visuals</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
                <span class="k">pass</span>

            <span class="c1">#  add collision objects to collision object list</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elink</span><span class="o">.</span><span class="n">collision</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">ob</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">link</span><span class="o">.</span><span class="n">collisions</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
                <span class="k">pass</span>

        <span class="c1"># connect the links using joint info</span>
        <span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joints</span><span class="p">:</span>
            <span class="c1"># get references to joint&#39;s parent and child</span>
            <span class="n">childlink</span><span class="p">:</span> <span class="s2">&quot;rtb.Link&quot;</span> <span class="o">=</span> <span class="n">elinkdict</span><span class="p">[</span><span class="n">joint</span><span class="o">.</span><span class="n">child</span><span class="p">]</span>
            <span class="n">parentlink</span> <span class="o">=</span> <span class="n">elinkdict</span><span class="p">[</span><span class="n">joint</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span>

            <span class="n">childlink</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parentlink</span>  <span class="c1"># connect child link to parent</span>
            <span class="n">childlink</span><span class="o">.</span><span class="n">_joint_name</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">name</span>
            <span class="c1"># Link precise definition will be done recursively later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elinks</span> <span class="o">=</span> <span class="n">elinks</span>

        <span class="c1"># TODO, why did you put the base_link on the end?</span>
        <span class="c1"># easy to do it here</span>

        <span class="c1"># the childlink.ets and other info is set recursively here</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_axis_definition</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_recursive_axis_definition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parentname</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parent_from_Rx_to_axis</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SE3</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively sets the ets of all elinks (in place).</span>

<span class="sd">        The ets of a link depends on the previous joint axis orientation.</span>
<span class="sd">        In a URDF a joint is defined as the following ets:</span>
<span class="sd">            ets = translation * rotation * axis * [Rx] * axis.inv()</span>
<span class="sd">        where Rx is the variable joint ets, and &quot;axis&quot; rotates the variable joint</span>
<span class="sd">        axis, BUT NOT the next link. Hence why Rx is rotated onto the axis, then</span>
<span class="sd">        the rotation is canceled by axis.inv().</span>

<span class="sd">        A Link is requiered to end with a variable ets -- this is our [Rx].</span>
<span class="sd">        The previous formula must therefore be changed and requires recursion:</span>
<span class="sd">            ets(N) = axis(N-1).inv() * transl(N) * rot(N) * axis(N) * [Rx]</span>
<span class="sd">        where N is the current joint, and (N-1) the parent joint.</span>
<span class="sd">        Chaining the ets of the second formula is equivalent to the first formula.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">            parentname: Optional[str]</span>
<span class="sd">                Name of the parent link.</span>
<span class="sd">            parent_from_Rx_to_axis: Optional[SE3]</span>
<span class="sd">                SE3 resulting from the axis orientation of the parent joint</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">parentname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># starts again with all orphan links</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elinks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_axis_definition</span><span class="p">(</span>
                        <span class="n">parentname</span><span class="o">=</span><span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_from_Rx_to_axis</span><span class="o">=</span><span class="kc">None</span>
                    <span class="p">)</span>
        <span class="k">if</span> <span class="n">parent_from_Rx_to_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent_from_Rx_to_axis</span> <span class="o">=</span> <span class="n">SE3</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">joint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joints</span><span class="p">:</span>  <span class="c1"># search  all joint with identical parent</span>
            <span class="n">is_parent</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="n">parentname</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_parent</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># skips to next joint</span>

            <span class="n">ets</span><span class="p">,</span> <span class="n">from_Rx_to_axis</span> <span class="o">=</span> <span class="n">_find_joint_ets</span><span class="p">(</span><span class="n">joint</span><span class="p">,</span> <span class="n">parent_from_Rx_to_axis</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">childlink</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elinks</span><span class="p">:</span>  <span class="c1"># search all link with identical child</span>
                <span class="n">is_child</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">child</span> <span class="o">==</span> <span class="n">childlink</span><span class="o">.</span><span class="n">name</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_child</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># skips to next link</span>

                <span class="n">childlink</span><span class="o">.</span><span class="n">ets</span> <span class="o">=</span> <span class="n">ets</span>  <span class="c1"># sets the ets of the joint</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">finalize_linking</span><span class="p">(</span><span class="n">childlink</span><span class="p">,</span> <span class="n">joint</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_axis_definition</span><span class="p">(</span>
                    <span class="n">parentname</span><span class="o">=</span><span class="n">childlink</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_from_Rx_to_axis</span><span class="o">=</span><span class="n">from_Rx_to_axis</span>
                <span class="p">)</span>

<div class="viewcode-block" id="URDF.finalize_linking">
<a class="viewcode-back" href="../../../api/easy_robot_control.my_rtb_fix.fixed_urdf.html#easy_robot_control.my_rtb_fix.fixed_urdf.URDF.finalize_linking">[docs]</a>
    <span class="k">def</span> <span class="nf">finalize_linking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">childlink</span><span class="p">:</span> <span class="s2">&quot;rtb.Link&quot;</span><span class="p">,</span> <span class="n">joint</span><span class="p">:</span> <span class="s2">&quot;Joint&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finalize the linking process after the link ets is set.</span>

<span class="sd">        This directly changes childlink in place.</span>
<span class="sd">        The ets of childlink must be defined prior to this.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">            childlink: rtb.Link</span>
<span class="sd">                Link to finalize the definition of.</span>
<span class="sd">            joint: Joint</span>
<span class="sd">                Joint used to define the link.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">childlink</span><span class="o">.</span><span class="n">isjoint</span><span class="p">:</span>
                <span class="n">childlink</span><span class="o">.</span><span class="n">qlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">joint</span><span class="o">.</span><span class="n">limit</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">joint</span><span class="o">.</span><span class="n">limit</span><span class="o">.</span><span class="n">upper</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># no joint limits provided</span>
            <span class="k">pass</span>

        <span class="c1"># joint friction</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">joint</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">friction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">childlink</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">joint</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">friction</span>

            <span class="c1"># TODO Add damping</span>
            <span class="c1"># joint.dynamics.damping</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># joint gear ratio</span>
        <span class="c1"># TODO, not sure if t.joint.name is a thing</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transmissions</span><span class="p">:</span>  <span class="c1"># pragma nocover</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">joint</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">childlink</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">actuators</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mechanicalReduction</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Elian Neppel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>